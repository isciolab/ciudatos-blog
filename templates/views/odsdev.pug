extends ../layouts/default

block vars
    - inner_padding = "padding: 0 15px"

block content
    <img style="width:100%" src="https://res.cloudinary.com/randommonkey/image/upload/v1531505257/ciudatos/cities/zcolwitwfetgjset3bfu.png"/>
    <div class="container">

        <div class="row">
            <div class="col-md-12">
                <ul class="nav nav-pills">
                <li role="presentation"  class="active"><a href="#ODS" data-toggle="tab">ODS</a></li>
                <li role="presentation"><a href="#CIUDADES" data-toggle="tab">CIUDADES</a></li>
                </ul>

                <div class="tab-content clearfix">
                    <div id="ODS" class="tab-pane active" >
                        <div class="row">
                            <div class="col-md-4">
                                <label>ODS:</label> <select id="changeOdsConcat" onchange="odsConcatFilter(value);">
                                <option value="">All</option>
                                <option value="01 PONER FIN A LA POBREZA EN TODAS SUS FORMAS EN TODO EL MUNDOODS1- .">01 PONER FIN A LA POBREZA EN TODAS SUS FORMAS EN TODO EL MUNDOODS1- .</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>META:</label>
                                <select id="changeTarget" onchange="targetFilter(value);">
                                <option value="">All</option>
                                <option value="Para 2030, ERRADICAR LA POBREZA EXTREMA para todas las personas en el mundo. Actualmente, se considera que viven en la pobreza extrema a las personas que subsisten con menos de 1,25 $ al día">
                                Para 2030, ERRADICAR LA POBREZA EXTREMA para todas las personas en el mundo. Actualmente, se considera que viven en la pobreza extrema a las personas que subsisten con menos de 1,25 $ al día</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>INDICADOR:</label>
                                <select id="changeTarget" onchange="">
                                <option value="">All</option>
                                <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">

                                 <div class='tableauPlaceholder' id='viz1538402928543' style='position: relative'><noscript><a href='#'><img alt='ods name ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;FJ&#47;FJ9G82PX9&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;FJ9G82PX9' /> <param name='toolbar' value='no' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;FJ&#47;FJ9G82PX9&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1538402928543');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                            </div>
                            <div class="col-md-4">

                            </div>
                            <div class="col-md-4">

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div id="vizContainer" style="width:800px; height:700px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane"  id="CIUDADES">

                    </div>
                </div>
            </div>
        </div>

    </div>

block js
    script(src="/vendors/iframeResizer.min.js")
    script(src="https://public.tableau.com/javascripts/api/tableau-2.min.js")
    script(src="/js/margin.js")
    script.
        var viz;
        $(document).ready(function () {

            initViz();

            $('iframe').iFrameResize({checkOrigin: false})

        })


        function initViz() {
            var containerDiv = document.getElementById("vizContainer"),
                url = "https://public.tableau.com/views/Ciudatos/metas?:embed=y&:display_count=yes&publish=yes&:toolbar=no",
                options = {
                    "ods concat": "",
                    hideTabs: true
                };

            viz = new tableau.Viz(containerDiv, url, options);
        }

        function odsConcatFilter(ods) {
            var sheet = viz.getWorkbook().getActiveSheet();
            if (ods === "") {
                sheet.clearFilterAsync("ods concat");
            } else {
                sheet.applyFilterAsync("ods concat", ods, tableau.FilterUpdateType.REPLACE);
            }
        }
        function targetFilter(target) {
            var sheet = viz.getWorkbook().getActiveSheet();
            if (target === "") {
                sheet.clearFilterAsync("Name (Targets)");
            } else {
                sheet.applyFilterAsync("Name (Targets)", target, tableau.FilterUpdateType.REPLACE);
            }
        }
